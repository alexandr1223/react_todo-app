(this["webpackJsonpreact_todo-app"]=this["webpackJsonpreact_todo-app"]||[]).push([[0],{14:function(t,e,n){},15:function(t,e,n){},16:function(t,e,n){},18:function(t,e,n){"use strict";n.r(e);var c,o=n(1),r=n.n(o),i=n(9),a=n.n(i),l=(n(14),n(15),n(16),n(3)),s=n(2),u=n(7),d=3643,j=function(t,e){return fetch("".concat("https://mate.academy/students-api/").concat(t),e).then((function(t){if(!t.ok)throw new Error("Error with loading data...");return t.json()}))},f=function(t,e){return j(t,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({completed:e})})},b=function(t){return j(t,{method:"DELETE",headers:{"Content-Type":"application/json"}})},p=n(0),m=function(t){var e=t.setTodos,n=Object(o.useState)(""),c=Object(s.a)(n,2),r=c[0],i=c[1],a=function(t){var n,c;t.preventDefault(),(n="todos/?userId=".concat(d),c=r,j(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:c,userId:d,completed:!1})})).then((function(t){e((function(e){return[].concat(Object(u.a)(e),[{id:+t.id,title:"".concat(t.title),completed:!1}])}))})),i("")};return Object(p.jsx)("form",{onSubmit:function(t){return a(t)},children:Object(p.jsx)("input",{type:"text",className:"new-todo",placeholder:"What needs to be done?",value:r,onChange:function(t){return i(t.target.value)}})})},h=n(4),O=n.n(h),y=function(t){var e=t.item,n=Object(o.useState)(!1),c=Object(s.a)(n,2),r=c[0],i=c[1],a=Object(o.useState)(e.title),u=Object(s.a)(a,2),d=u[0],m=u[1],h=Object(o.useContext)(g).setTodos;Object(o.useEffect)((function(){var t=function(t){27===t.keyCode&&(""===e.title&&v(e.id),y(e.id,d),i(!1))};return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}}),[]);var y=function(t,e){(function(t,e){return j(t,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e})})})("todos/".concat(t),e).then((function(){h((function(n){return n.map((function(n){return n.id===t?Object(l.a)(Object(l.a)({},n),{},{title:e}):n}))}))}))},v=function(t){b("todos/".concat(t)).then((function(){h((function(e){return e.filter((function(e){return e.id!==t}))}))}))};return Object(p.jsxs)("li",{className:O()({completed:e.completed},{editing:r}),children:[Object(p.jsxs)("div",{className:"view",children:[Object(p.jsx)("input",{type:"checkbox",className:"toggle",checked:e.completed,id:e.completed?"toggle-completed":"toggle-view",onChange:function(){return t=e.id,n=!e.completed,void f("todos/".concat(t),n).then((function(){h((function(e){return e.map((function(e){return e.id===t?Object(l.a)(Object(l.a)({},e),{},{completed:!e.completed}):e}))}))}));var t,n}}),Object(p.jsx)("label",{onDoubleClick:function(){i(!0)},children:e.title}),Object(p.jsx)("button",{type:"button",className:"destroy","data-cy":"deleteTodo",onClick:function(){return v(e.id)}})]}),Object(p.jsx)("input",{type:"text",className:"edit",value:d,onChange:function(t){return m(t.target.value)},onBlur:function(t){return function(t){""===t.target.value?(v(e.id),i(!1)):(y(e.id,d),i(!1))}(t)},onKeyPress:function(t){return function(t){"Enter"===t.key&&(""===t.target.value?(v(e.id),i(!1)):i(!1)),27===t.keyCode&&i(!1)}(t)}})]})},v=function(t){var e=t.items,n=t.sortBy,c=Object(u.a)(e);switch(n){case"active":c=c.filter((function(t){return!1===t.completed}));break;case"completed":c=c.filter((function(t){return!0===t.completed}))}return Object(p.jsx)("ul",{className:"todo-list","data-cy":"todoList",children:c&&c.map((function(t){return Object(p.jsx)(y,{item:t},t.id)}))})};!function(t){t.All="all",t.Active="active",t.Completed="completed"}(c||(c={}));var x=function(t){var e=t.sortBy,n=t.setSortBy;return Object(p.jsxs)("ul",{className:"filters",children:[Object(p.jsx)("li",{children:Object(p.jsx)("button",{type:"button",className:O()({selected:e===c.All}),onClick:function(){return n(c.All)},children:"All"})}),Object(p.jsx)("li",{children:Object(p.jsx)("button",{type:"button",className:O()({selected:e===c.Active}),onClick:function(){return n(c.Active)},children:"Active"})}),Object(p.jsx)("li",{children:Object(p.jsx)("button",{type:"button",className:O()({selected:e===c.Completed}),onClick:function(){return n(c.Completed)},children:"Completed"})})]})},g=r.a.createContext({}),C=function(){var t=function(t,e){var n=Object(o.useState)((function(){try{var n=window.localStorage.getItem(t);return n?JSON.parse(n):e}catch(c){return e}})),c=Object(s.a)(n,2),r=c[0],i=c[1];return[r,function(e){try{var n=e instanceof Function?e(r):e;i(n),window.localStorage.setItem(t,JSON.stringify(n))}catch(c){throw new Error("Error")}}]}("todos",[]),e=Object(s.a)(t,2),n=e[0],r=e[1],i=Object(o.useState)(!1),a=Object(s.a)(i,2),u=a[0],h=a[1],O=Object(o.useState)(c.All),y=Object(s.a)(O,2),C=y[0],N=y[1];Object(o.useEffect)((function(){var t;(t="todos/?userId=".concat(d),j(t)).then((function(t){r(t)}))}),[]),Object(o.useEffect)((function(){var t=n.every((function(t){return!0===t.completed}));h(!!t)}),[n]);var w={setTodos:r};return Object(p.jsxs)("section",{className:"todoapp",children:[Object(p.jsxs)("header",{className:"header",children:[Object(p.jsx)("h1",{children:"todos"}),Object(p.jsx)(m,{setTodos:r})]}),Object(p.jsxs)("section",{className:"main",children:[n.length>0&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("input",{type:"checkbox",id:"toggle-all",checked:u,className:"toggle-all",onChange:function(){r((function(t){return t.map((function(t){return t.completed!==!u?(f("todos/".concat(t.id),!u),Object(l.a)(Object(l.a)({},t),{},{completed:!u})):t}))})),h(!u)}}),Object(p.jsx)("label",{htmlFor:"toggle-all",children:"Mark all as complete"})]}),Object(p.jsx)(g.Provider,{value:w,children:Object(p.jsx)(v,{items:n,sortBy:C})})]}),n.length>0&&Object(p.jsxs)("footer",{className:"footer",children:[Object(p.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:"".concat(n.length>0?n.filter((function(t){return!t.completed})).length:0," items left")}),Object(p.jsx)(x,{sortBy:C,setSortBy:N}),(n.length>0?n.filter((function(t){return t.completed})).length:"")>0&&Object(p.jsx)("button",{type:"button",className:"clear-completed",onClick:function(){n.forEach((function(t){!0===t.completed&&b("todos/".concat(t.id)).then(r(n.filter((function(t){return!0!==t.completed}))))}))},children:"Clear completed"})]})]})};a.a.render(Object(p.jsx)(C,{}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.81b3e805.chunk.js.map